<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <style media="screen">
    .margin{
      margin-top: 20px;
    }
  </style>
  <title>LOGIN</title>
</head>

<body>
  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="1">Open modal for @mdo</button>

  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">배송 정보 입력</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form>
          <div class="modal-body">
            <p>주문번호 :</p>
            <h1></h1>
            <input type="hidden" name="code" value="">
            <div class="form-group">
              <label for="recipient-name" class="col-form-label">택배회사 코드:</label>
              <input type="text" class="form-control" name="companyCode">
            </div>
            <div class="form-group">
              <label for="message-text" class="col-form-label">운송장 번호:</label>
              <input type="text" class="form-control" name="invoiceNumber">
            </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
            <button type="button" class="btn btn-primary" id="submit">입력</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</body>

</html>
<script type="text/javascript">
$('#exampleModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var recipient = button.data('whatever') // Extract info from data-* attributes
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
  $('h1').text(recipient);
  $('input[name=code]').val(recipient);
})
  $('#submit').click(function(){
    $.ajax({
      url: "${contextPath}/admin/registerShippingInfo",
      method: "POST",
      data: {
        code: $("input[name=code]").val(),
        companyCode: $("input[name=companyCode]").val(),
        invoiceNumber: $("input[name=invoiceNumber]").val()
      },
      type: "json"
    }).done(function(resultData) {


    }).fail(function() {
      alert("통신 오류");
    }).always(function() {});
  });
  function test() {
    $.ajax({
      url: "http://info.sweettracker.co.kr/api/v1/trackingInfo",
      method: "GET",
      data: {
        t_key: "pIaxM5d2cce16NTj88IbPA",
        t_code: "06",
        t_invoice: "91950413391"
      },
      type: "json"
    }).done(function(resultData) {
      var shippingInfo = "";
      shippingInfo = shippingInfo + "<p>";
      shippingInfo = shippingInfo + "보내는 사람 : " + resultData.senderName + "<br>";
      shippingInfo = shippingInfo + "받는 사람 : " + resultData.receiverName + "<br>";
      shippingInfo = shippingInfo + "받는 주소 : " + resultData.receiverAddr + "<br>";
      shippingInfo = shippingInfo + "</p>";
      $('#shipping-info').html(shippingInfo);
      var trackingInfo = "";

      for (var i = 0; i < resultData.trackingDetails.length; i++) {
        trackingInfo = trackingInfo + "<tr>"
        trackingInfo = trackingInfo + "<td>" + resultData.trackingDetails[i].timeString + "</td>";
        trackingInfo = trackingInfo + "<td>" + resultData.trackingDetails[i].where + "</td>";
        trackingInfo = trackingInfo + "<td>" + resultData.trackingDetails[i].kind + "</td>";
        trackingInfo = trackingInfo + "</tr>"
      }
      $('#tracking-info').html(trackingInfo);

    }).fail(function() {
      alert("통신 오류");
    }).always(function() {});
  }
</script>
